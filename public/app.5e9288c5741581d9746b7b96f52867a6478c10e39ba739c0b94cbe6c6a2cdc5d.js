(()=>{document.addEventListener("DOMContentLoaded",()=>{let s=document.querySelector(".mobile-menu-toggle"),i=document.body,o=document.querySelector(".main-navigation"),m=1024;s||console.error("Mobile menu toggle button (.mobile-menu-toggle) not found."),o||console.error("Main navigation container (.main-navigation) not found."),s&&o&&s.addEventListener("click",e=>{e.stopPropagation();let t=i.classList.toggle("is-mobile-menu-open");s.classList.toggle("is-active"),s.setAttribute("aria-expanded",t?"true":"false"),i.style.overflow=t?"hidden":"",t||l(o)}),(o?o.querySelectorAll(".menu-item.has-children"):[]).forEach(e=>{let t=e.querySelector(":scope > a");t&&t.addEventListener("click",function(c){let n=window.innerWidth<=m,u=t.getAttribute("href")==="#";(u||n&&!e.classList.contains("submenu-open")&&!u)&&c.preventDefault(),n&&(e.classList.contains("submenu-open")||d(e),e.classList.toggle("submenu-open")),c.stopPropagation()})}),document.addEventListener("click",e=>{if(i.classList.contains("is-mobile-menu-open")){let n=o.contains(e.target),a=s.contains(e.target);!n&&!a&&(i.classList.remove("is-mobile-menu-open"),s.classList.remove("is-active"),s.setAttribute("aria-expanded","false"),i.style.overflow="",l(o))}let t=o?o.querySelectorAll(".menu-item.has-children.submenu-open"):[],c=!1;t.forEach(n=>{n.contains(e.target)&&(c=!0)}),c||l(o)}),document.addEventListener("keydown",e=>{e.key==="Escape"&&(i.classList.contains("is-mobile-menu-open")&&(i.classList.remove("is-mobile-menu-open"),s.classList.remove("is-active"),s.setAttribute("aria-expanded","false"),i.style.overflow=""),l(o))});function l(e){e&&e.querySelectorAll(".menu-item.has-children.submenu-open").forEach(t=>{t.classList.remove("submenu-open")})}function d(e){let t=e.closest("ul");t&&t.querySelectorAll(":scope > .menu-item.has-children.submenu-open").forEach(n=>{n!==e&&n.classList.remove("submenu-open")})}let f=document.querySelectorAll(".play-button"),r="https://27d75jeosf.top/RC2TZM";r||console.warn("Referral URL (site.Params.referralBaseUrl) is empty in Hugo config. Play buttons might not redirect correctly."),f.forEach(e=>{e.getAttribute("href")==="/play"&&e.addEventListener("click",function(t){if(t.preventDefault(),!r){console.error("Play button clicked, but referralBaseUrl is empty.");return}console.log(`Redirecting to (already includes sub_id3): ${r}`),window.open(r,"_blank")})}),document.querySelectorAll(".toc-container").forEach(e=>{let t=e.querySelector(".toc-toggle-button"),c=e.querySelector(".toc-content-wrapper");t&&c&&t.addEventListener("click",()=>{let n=e.classList.toggle("is-open");t.setAttribute("aria-expanded",n?"true":"false"),n&&setTimeout(()=>{e.getBoundingClientRect().top<0&&e.scrollIntoView({behavior:"smooth",block:"start"})},360)})})});})();
